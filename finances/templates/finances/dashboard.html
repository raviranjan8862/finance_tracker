{% load static %}
{% load custom_tags %}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Finance Dashboard</title>
    <link rel="stylesheet" href="{% static 'css/dashboard_style.css' %}">
</head>
<body>
    <div class="dashboard-container">
        <div class="content"> <!-- Main content on the left -->
            <div class="card-container">
                <div class="card card-income">
                    <h3>Monthly Income</h3>
                    <div class="amount">${{ monthly_income }}</div>
                </div>
                <div class="card card-expenses">
                    <h3>Monthly Expenses</h3>
                    <div class="amount">${{ monthly_expenses }}</div>
                </div>
                <div class="card card-balance">
                    <h3>Monthly Balance</h3>
                    <div class="amount">${{ monthly_balance }}</div>
                </div>
            </div>
    
            <div class="card-container">
                <div class="card card-income">
                    <h3>Yearly Income</h3>
                    <div class="amount">${{ yearly_income }}</div>
                </div>
                <div class="card card-expenses">
                    <h3>Yearly Expenses</h3>
                    <div class="amount">${{ yearly_expenses }}</div>
                </div>
                <div class="card card-balance">
                    <h3>Yearly Balance</h3>
                    <div class="amount">${{ yearly_balance }}</div>
                </div>
            </div>
              <!-- Add Transaction Button Centered Below Transaction List -->
              <div class="center-button-container">
                <a href="{% url 'add_transaction' %}" class="btn btn-primary">Add Transaction</a>
            </div>
            
            <div class="transaction-list">
                <!-- your_template.html -->
                <!-- your_template.html -->
                <h2>Transactions for {{ current_month_name }} {{ current_year }}</h2>


            
                {% for transaction in transactions %}
                <div class="transaction-item">
                    <div class="transaction-date">
                        {{ transaction.date }}
                    </div>
                    <div class="transaction-category">
                        {{ transaction.category.name }}
                    </div>
                    <div class="transaction-amount {% if transaction.transaction_type == 'income' %}amount-income{% else %}amount-expense{% endif %}">
                        ${{ transaction.amount }}
                    </div>
                    <div class="transaction-edit">
                        <a href="{% url 'update_transaction' transaction.id %}" class="btn btn-warning">Edit</a>
                        <a href="{% url 'delete-transaction' transaction.id %}" class="btn btn-danger" onclick="return confirm('Are you sure you want to delete this transaction?');">Delete</a>
                    </div>
                </div>
                {% empty %}
                <p>No transactions found for this month.</p>
                {% endfor %}
            </div>
            
            

       
            
        </div>


    
        <div class="filter-container"> <!-- Filter card on the right -->
            <div class="filter-card">
                <h2>Filters</h2> <!-- Optional header for the filter card -->
                <div class="filter-form">
                    <form method="get" action="{% url 'dashboard' %}">
                        <label for="month">Select Month:</label>
                        <select name="month" id="month" class="styled-select">
                            {% for m in month_names %}
                            <option value="{{ forloop.counter }}" {% if forloop.counter == current_month %}selected{% endif %}>
                                {{ m }}
                            </option>
                            {% endfor %}
                        </select>
    
                        <label for="year">Select Year:</label>
                        <select name="year" id="year" class="styled-select">
                            {% for y in 2022|year_range:2030 %}
                            <option value="{{ y }}" {% if y == current_year %}selected{% endif %}>{{ y }}</option>
                            {% endfor %}
                        </select>
    
                        <button type="submit" class="styled-button">Filter</button>
                    </form>
                </div>
            </div>
        </div>
    </div>
</body>
</html>
